<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF8">
    <title>Rose Garden</title>
    <style>
      body {
        -webkit-user-select: none;
        user-select: none;
        -webkit-app-region: drag;
        overflow: hidden;
      }
      #rose {
        height: 100vh;
        pointer-events: none;
      }
      .petal {
        top: 0;
        opacity: 1;
        width: 30vw;
        position: absolute;
        border-style: none;
        background: transparent;
      }
      .petal.transparent {
        opacity: 0;
        transition: opacity 5s linear 1s;
      }
    </style>
    <script>
      window.onload = () => {

        const period = 10;
        const freq = 1/period;
        const fallTime = 10;
        const fps = 100;

        const petalMaker = () => {
          const petal = document.createElement('img');
          petal.src = 'petal.png';
          petal.classList.add('petal');
          document.body.appendChild(petal);

          let t = 0;
          let top = 0;
          const L = Math.random() * (50 - 20) + 20;
          const next = Math.random() * (8000 - 2000) + 2000;
          const xOff = Math.random() * (50 - 20) + 20;
          const faller = window.setInterval(() => {
            const x = L*Math.cos(2*Math.PI*t*(period * Math.PI / 96));
            const y = Math.sqrt((L*L) - (x*x)) / 2;
            const th = Math.asin(x/L);
            petal.style.left = `${xOff + x}vw`;
            petal.style.top = `${top + y}vh`;
            petal.style.transform = `rotate(${Math.PI / 2 - th/2}rad)`
            t += 1/fps;
            top = (t / fallTime)*90;
            if ((top + y) > 90) {
              window.clearInterval(faller);
              petal.classList.add('transparent');
              window.setTimeout(() => petal.remove(), 10000);
            }
          }, 1000 / fps);
          if (window.makePetals) {
            window.setTimeout(() => petalMaker(), next);
          }
        }
        petalMaker();
      }

    </script>
  </head>
  <body>
    <script>
    </script>
    <img id="rose" draggable="false" src="rose.png">
  </body>
</html>